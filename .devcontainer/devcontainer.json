{
  "name": "android-codespace",

  // Build with the Dockerfile in this repo
  "build": { "dockerfile": "Dockerfile" },

  "features": {
    // Java 17 via SDKMAN! (installs Gradle when we ask for it)
    "ghcr.io/devcontainers/features/java:1":  { "version": "17", "installGradle": true },

    // Latest Gradle CLI (makes gradle wrapper optional)
    "ghcr.io/devcontainers/features/gradle:1": {},

    // Android SDK / Platform-tools / Build-tools 34.0.0
    "ghcr.io/casl0/devcontainer-features/android-sdk:1": { "version": "34.0.0" },

    // Flutter SDK (hsun1031 keeps it up to date for dev-containers)
    "ghcr.io/hsun1031/devcontainer_flutter:latest": {}
  },

  // Add Flutter’s bin dir to every future shell
  "containerEnv": {
    "PATH": "${containerEnv:PATH}:/workspaces/${localWorkspaceFolderBasename}/.devcontainer/flutter/bin"
  },

  "postCreateCommand": [
    // Make sure our licence helper is executable, then run it
    "chmod +x .devcontainer/scripts/accept-android-licenses.sh",
    ".devcontainer/scripts/accept-android-licenses.sh",

    // Sanity-check tool versions
    "java -version",
    "gradle --version",

    // If this repo has an Android-specific gradle wrapper, show its version too
    "[ -f android/gradlew ] && chmod +x android/gradlew && android/gradlew --version || true",

    // Throw away SDKMAN / apt caches to keep the image smaller
    "sdk flush archives > /dev/null || true",
    "sudo apt-get clean"
  ],

  "customizations": {
    "vscode": {
      "extensions": [
        "vscjava.vscode-gradle",
        "eamodio.gitlens",
        "ms-vscode.cpptools",
        "dart-code.flutter"
      ]
    }
  },

  // Typical ports: adb → 5555, dev-server / emulator bridge → 8080
  "forwardPorts": [5555, 8080]

  // ⬅️  **NO remoteUser key**: the default 'vscode' account will be used
}
