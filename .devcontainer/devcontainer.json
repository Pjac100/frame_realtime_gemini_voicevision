{
  "name": "Flutter-Android Dev",

  // Base image = the same Ubuntu-24.04 image your CI runner used
  "image": "mcr.microsoft.com/devcontainers/base:ubuntu-24.04",

  "features": {
    "ghcr.io/devcontainers/features/common-utils": "2",
    "ghcr.io/devcontainers/features/java": "1",

    // Android SDK pinned to the tag that worked in your CI logs
    "ghcr.io/casl0/devcontainer-features/android-sdk": {
      "version": "34",
      "ndk": "26.3.11579264",
      "cmdline-tools": "11076708",
      "cmake": "3.22.1"
    }
  },

  /* -----------------------------------------------------------
     Run the Flutter installer **via bash** so the script itself
     does NOT need the executable bit set in the repo.
  ----------------------------------------------------------- */
  "postCreateCommand": "bash .devcontainer/scripts/setup_flutter.sh",

  "customizations": {
    "codespaces": {
      // Freeze the CLI at 0.74.3 (avoids the chmod bug)
      "devcontainerCLI": "0.74.3"
    },
    "vscode": {
      "extensions": [
        "dart-code.flutter",
        "dart-code.dart-code"
      ]
    }
  },

  "forwardPorts": [3000],
  "remoteUser": "vscode"
}
